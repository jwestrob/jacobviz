# Interactive Contact Map Visualization

## Overview

This project is an interactive visualization tool for exploring contact maps generated by the **categorical Jacobian method**. It allows users to:

- Visualize a symmetrical contact map matrix representing coevolutionary residues between one or more sequences.
- Display the corresponding sequences above the heatmap with interactive highlighting.
- Hover over cells in the heatmap to highlight the corresponding positions in the sequences.
- Manually highlight residues in the sequences by clicking on them.
- Zoom and pan within the heatmap for detailed exploration.

This tool is particularly useful for bioinformatics applications, where understanding the interactions and coevolution between residues in sequences (such as DNA, RNA, or proteins) is essential.

## Features

- **Interactive Heatmap**: Visualizes the contact map with an inverted Y-axis to match sequence positions.
- **Sequence Display**: Shows one or more sequences above the heatmap, with automatic wrapping and clear separation between sequences.
- **Hover Highlighting**: Highlights the corresponding residues in the sequences when hovering over cells in the heatmap.
- **Manual Highlighting**: Allows users to manually highlight residues in the sequences by clicking on them.
- **Zoom and Pan**: Enables users to zoom into and pan around the heatmap for detailed inspection.

## Table of Contents

- [Project Structure](#project-structure)
- [Getting Started](#getting-started)
  - [Prerequisites](#prerequisites)
  - [Installation](#installation)
- [Usage](#usage)
  - [Running the Visualization](#running-the-visualization)
  - [Interacting with the Tool](#interacting-with-the-tool)
- [Data Format](#data-format)
  - [Sequences](#sequences)
  - [Contact Map Matrix](#contact-map-matrix)
- [Customization](#customization)
  - [Adjusting Layout and Styles](#adjusting-layout-and-styles)
  - [Modifying Zoom Behavior](#modifying-zoom-behavior)
- [Troubleshooting](#troubleshooting)
- [License](#license)
- [Acknowledgments](#acknowledgments)

## Project Structure

```
interactive-contact-map/
├── index.html
├── styles.css
├── script.js
├── data/
│   ├── sequences.txt
│   └── contact_map.csv
├── README.md
```

- **index.html**: The main HTML file that loads the visualization.
- **styles.css**: Contains CSS styles for the visualization.
- **script.js**: JavaScript file with the logic for data processing and visualization using D3.js.
- **data/**: Directory containing data files.
  - **sequences.txt**: Text file with sequences in the specified format.
  - **contact_map.csv**: CSV file containing the contact map matrix.
- **README.md**: Documentation and usage instructions for the project.

## Getting Started

### Prerequisites

- **Web Browser**: A modern web browser that supports JavaScript and SVG rendering (e.g., Chrome, Firefox, Safari).
- **Local Web Server**: To run the visualization locally, you need to serve the files using a local web server due to browser security restrictions.

### Installation

1. **Clone the Repository**: Clone this repository to your local machine.

   ```bash
   git clone https://github.com/your-username/interactive-contact-map.git
   ```

2. **Navigate to the Project Directory**:

   ```bash
   cd interactive-contact-map
   ```

3. **Prepare Your Data**:

   - Place your sequences in `data/sequences.txt` using the specified format.
   - Place your contact map matrix in `data/contact_map.csv`.

## Usage

### Running the Visualization

Since browsers restrict access to local files for security reasons, you'll need to run a local web server to view the visualization.

#### Using Python's SimpleHTTPServer

If you have Python installed, you can use the built-in HTTP server.

  ```bash
  python -m http.server 8000
  ```

#### Using Node.js http-server

If you have Node.js installed:

1. Install the `http-server` package globally:

   ```bash
   npm install -g http-server
   ```

2. Start the server:

   ```bash
   http-server -p 8000
   ```

#### Accessing the Visualization

Open your web browser and navigate to:

```
http://localhost:8000
```


### Interacting with the Tool

- **Hover Over Heatmap Cells**: When you hover over a cell in the heatmap:
  - The corresponding residues in the sequences are highlighted in **yellow**.
  - A tooltip appears showing the cell's value and matrix indices.
- **Manual Highlighting**: Click on any residue in the sequences to toggle manual highlighting in **light blue**.
  - If a residue is both manually and hover-highlighted, it appears in **orange**.
- **Zoom and Pan**:
  - **Zoom**: Use your mouse scroll wheel or trackpad gestures to zoom in and out of the heatmap.
  - **Pan**: Click and drag the heatmap to pan around when zoomed in.
- **Sequences Display**:
  - Sequences are displayed above the heatmap.
  - Each sequence starts on a new line with a blank line between sequences.
  - Sequences wrap to the next line when they reach the end of the container.

## Data Format

### Sequences

- **File**: `data/sequences.txt`
- **Format**:
  - Sequences are provided as a string.
  - Sequences are separated by the `'<+>'` token.
  - Every sequence starts with a `'<+>'` token.
  - Example:

    ```
    <+>TTGTAAGACCTACCTAGTAGGCTGAGTTTGCTTGATC<+>GSAMASNAVLYKSNHNVVYSCKYHIVWCPKYRRKVL
    ```

### Contact Map Matrix

- **File**: `data/contact_map.csv`
- **Format**:
  - A symmetrical matrix provided in CSV format.
  - Each row represents a row in the matrix.
  - Values are separated by commas.
  - Example:

    ```csv
    0.0,0.1,0.2,...
    0.1,0.0,0.3,...
    0.2,0.3,0.0,...
    ...
    ```

- Ensure that the matrix dimensions match the total length of the concatenated sequences (including separators).

## Customization

### Adjusting Layout and Styles

- **Sequence Container Width**:
  - Adjust the width of sequences in `styles.css`:

    ```css
    #sequences-container {
        width: 80%; /* Adjust to 100% or as needed */
    }
    ```

- **Font Size and Styles**:
  - Modify font sizes or styles for residues in `styles.css`:

    ```css
    .residue {
        font-size: 14px; /* Adjust font size */
        /* Add additional styles if needed */
    }
    ```

- **Color Scheme**:
  - Change the color interpolation for the heatmap in `script.js`:

    ```javascript
    const colorScale = d3.scaleSequential(d3.interpolateViridis)
        .domain([minValue, maxValue]);
    ```

  - Replace `d3.interpolateViridis` with other D3 color schemes (e.g., `d3.interpolatePlasma`).

### Modifying Zoom Behavior

- **Zoom Extent**:
  - Adjust the zoom scale in `script.js`:

    ```javascript
    .scaleExtent([1, 10]) // Change to desired zoom levels
    ```

- **Disable Panning or Zooming**:
  - Remove or modify the zoom behavior in the `renderHeatmap` function.

## Troubleshooting

- **Visualization Not Displaying**:
  - Ensure that you are running a local web server and accessing the visualization via `http://localhost:8000/`.
  - Check the browser console for any JavaScript errors.

- **Data Loading Issues**:
  - Verify that `sequences.txt` and `contact_map.csv` are correctly formatted and placed in the `data/` directory.
  - Ensure that the contact map matrix dimensions match the total sequence length (including separators).

- **Performance Problems**:
  - For very large sequences or matrices, the visualization may become slow.
  - Consider optimizing the data or reducing the size for testing.

- **Highlighting Not Accurate**:
  - Confirm that the sequence positions correctly map to the matrix indices.
  - Check the `calculateSequencePositions` function in `script.js` for potential issues.

## License

This project is licensed under the [MIT License](LICENSE).

